<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Reset Password - Ghana Market</title><link rel="stylesheet" href="style.css"></head><body><main class="main"><div class="container"><div class="card form-card"><h2 class="section-title text-center">Set New Password</h2><p id="message" class="text-center text-sm mb-4"></p><form id="resetPasswordForm"><div class="form-group"><input type="password" id="newPassword" class="form-input" placeholder="New Password" required></div><div class="form-group"><input type="password" id="confirmPassword" class="form-input" placeholder="Confirm New Password" required></div><button type="submit" class="btn btn-primary" style="width: 100%;">Set New Password</button></form></div></div></main><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script type="module">import { createClient } from '@supabase/supabase-js';

const supabaseUrl = 'https://acysegqhxdjhlhjotlhv.supabase.co'; // Replace with your Supabase URL
const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFjeXNlZ3FoeGRqaGxoam90bGh2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3ODIzOTIsImV4cCI6MjA3MjM1ODM5Mn0.xYEIA_QPaaYJxGfuWzGDehrxJjETTR4A5T3votJb_8I'; // Replace with your Supabase Anon Key

const supabase = createClient(supabaseUrl, supabaseAnonKey);

document.addEventListener('DOMContentLoaded', () => {
    const resetPasswordForm = document.getElementById('resetPasswordForm');
    const newPasswordInput = document.getElementById('newPassword');
    const confirmPasswordInput = document.getElementById('confirmPassword');
    const messageDisplay = document.getElementById('message');

    const displayMessage = (msg, isError = false) => {
        messageDisplay.textContent = msg;
        messageDisplay.className = isError ? 'text-red-500' : 'text-green-500';
    };

    resetPasswordForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const newPassword = newPasswordInput.value;
        const confirmPassword = confirmPasswordInput.value;

        if (newPassword !== confirmPassword) {
            displayMessage('Passwords do not match.', true);
            return;
        }

        if (newPassword.length < 6) {
            displayMessage('Password must be at least 6 characters long.', true);
            return;
        }

        try {
            // Supabase automatically picks up the access_token from the URL
            const { error } = await supabase.auth.updateUser({
                password: newPassword
            });

            if (error) throw error;

            displayMessage('Your password has been updated successfully! Redirecting to login...', false);
            setTimeout(() => {
                window.location.href = '/'; // Redirect to your login page (e.g., index.html)
            }, 3000);

        } catch (error) {
            console.error('Error updating password:', error);
            displayMessage(`Error updating password: ${error.message}`, true);
        }
    });

    // Optional: Check for access_token on page load if needed for specific flows
    // const urlParams = new URLSearchParams(window.location.hash.substring(1));
    // const accessToken = urlParams.get('access_token');
    // if (!accessToken) {
    //     displayMessage('Invalid or missing reset token.', true);
    //     // Optionally redirect to login or home if no token
    // }
});</script></body></html>